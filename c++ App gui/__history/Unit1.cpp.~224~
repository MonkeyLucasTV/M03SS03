//---------------------------------------------------------------------------

#include <vcl.h>
#include "IRClientTCP.h"
#pragma hdrstop
#include <iostream>
#include <string>
#include "LampeMulticolore.h"
#include "Unit1.h"
#include "CapteurTemperature.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
TForm1 *Form1;


//---------------------------------------------------------------------------
__fastcall TForm1::TForm1(TComponent* Owner)
	: TForm(Owner)
{
	 ipServ = ((AnsiString)Edit1->Text).c_str();

}
//---------------------------------------------------------------------------




void __fastcall TForm1::Button1Click(TObject *Sender)
{

	Timer1->Enabled = true;
	


}

//---------------------------------------------------------------------------


void __fastcall TForm1::Timer1Timer(TObject *Sender)
{

Domotique Dom(ipServ, "988FB76B99");
	CapteurTemperature temp(((AnsiString)Edit1->Text).c_str() ,"988FB76B99", "Temp A7-1");

	Temp->Caption =  "Temperature : " + UnicodeString(temp.Temperature().insert(2,",").c_str()) +"°C");
	Humid->Caption = "Humidité : "+ UnicodeString(temp.Humidite().c_str());
	press->Caption = "Pression : "+ UnicodeString(temp.Pression().c_str());

       RichEdit1->Lines->Delete(1000);
	std::string RichEditText = Dom.ListeCapteurs();
	RichEditText +=  Dom.ListeLampes();

	RichEdit1->Lines->Add(RichEditText.c_str());

	Timer1->Enabled = false;
}

//---------------------------------------------------------------------------

void __fastcall TForm1::TrackBar1Change(TObject *Sender)
{
	LampeMulticolore Lampe(ipServ,"988FB76B99",(((AnsiString)Edit3->Text).c_str()) , ((AnsiString)ComboBox1->Text).c_str());
	Lampe.Teinte(AnsiString(TrackBar1->Position).c_str());

}
//---------------------------------------------------------------------------

void __fastcall TForm1::TrackBar2Change(TObject *Sender)
{
	LampeMulticolore Lampe1(ipServ,"988FB76B99",(((AnsiString)Edit3->Text).c_str()),((AnsiString)ComboBox1->Text).c_str());
	Lampe1.Intensite(AnsiString(TrackBar2->Position).c_str());
}
//---------------------------------------------------------------------------

void __fastcall TForm1::Button2Click(TObject *Sender)
{

	LampeMulticolore Lampe2(ipServ,"988FB76B99",(((AnsiString)Edit3->Text).c_str()), ((AnsiString)ComboBox1->Text).c_str());

	if (Button2->Caption == "0") {
		Lampe2.Allumer("true");
		Button2->Caption = "1";
	}
	else if (Button2->Caption == "1") {
		Lampe2.Allumer("false");
		Button2->Caption = "0";
	}

}
//---------------------------------------------------------------------------

void __fastcall TForm1::ComboBox1Change(TObject *Sender)
{

	std::string NbrL = ((AnsiString)ComboBox1->Text).c_str();
	Edit3->Text = "Extended Lights " + ComboBox1->Text;
	LampeMulticolore LampeListe(ipServ,"988FB76B99","Extended Lights "+NbrL,NbrL);





//	LampeMulticolore LampeListe(ipServ,"988FB76B99","Extended Lights 3","3");
//
//	if (NmbreL== "0") {
//		LampeMulticolore LampeListe(ipServ,"988FB76B99","Extended Lights 3","3");
//		Edit3->Text = "Extended Lights 3";
//	}
//	else if (NmbreL == 1) {
//		LampeMulticolore LampeListe(ipServ,"988FB76B99","Extended Lights 4","4");
//		Edit3->Text = "Extended Lights 4";
//	}

}
//---------------------------------------------------------------------------

